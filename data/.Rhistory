symbols <- c(
acute = "áéíóúÁÉÍÓÚýÝ",
grave = "àèìòùÀÈÌÒÙ",
circunflex = "âêîôûÂÊÎÔÛ",
tilde = "ãõÃÕñÑ",
umlaut = "äëïöüÄËÏÖÜÿ",
cedil = "çÇ"
)
nudeSymbols <- c(
acute = "aeiouAEIOUyY",
grave = "aeiouAEIOU",
circunflex = "aeiouAEIOU",
tilde = "aoAOnN",
umlaut = "aeiouAEIOUy",
cedil = "cC"
)
accentTypes <- c("´","`","^","~","¨","ç")
if(any(c("all","al","a","todos","t","to","tod","todo")%in%pattern)) # opcao retirar todos
return(chartr(paste(symbols, collapse=""), paste(nudeSymbols, collapse=""), str))
for(i in which(accentTypes%in%pattern))
str <- chartr(symbols[i],nudeSymbols[i], str)
return(str)
}
data4 <- data3 %>%
mutate(prov = rm_accent(prov),
dep = rm_accent(dep))
data <- read_csv("covid_casos_positivos.csv")
data2 <- data %>%
filter(FECHA_RESULTADO < "2021-01-01")
data3 <- readxl::read_xlsx("reporte.xlsx") %>%
separate(Provincia , into = c("dep","name","prov"),sep = ",") %>%
select(dep,prov,Población) %>%
mutate_if(is.character,str_to_upper)
data <- read_csv("covid_casos_positivos.csv")
data2 <- data %>%
filter(FECHA_RESULTADO < "2021-01-01")
data3 <- readxl::read_xlsx("reporte.xlsx") %>%
separate(Provincia , into = c("dep","name","prov"),sep = ",") %>%
select(dep,prov,Población) %>%
mutate_if(is.character,str_to_upper)
rm_accent <- function(str,pattern="all") {
if(!is.character(str))
str <- as.character(str)
pattern <- unique(pattern)
if(any(pattern=="Ç"))
pattern[pattern=="Ç"] <- "ç"
symbols <- c(
acute = "áéíóúÁÉÍÓÚýÝ",
grave = "àèìòùÀÈÌÒÙ",
circunflex = "âêîôûÂÊÎÔÛ",
tilde = "ãõÃÕñÑ",
umlaut = "äëïöüÄËÏÖÜÿ",
cedil = "çÇ"
)
nudeSymbols <- c(
acute = "aeiouAEIOUyY",
grave = "aeiouAEIOU",
circunflex = "aeiouAEIOU",
tilde = "aoAOnN",
umlaut = "aeiouAEIOUy",
cedil = "cC"
)
accentTypes <- c("´","`","^","~","¨","ç")
if(any(c("all","al","a","todos","t","to","tod","todo")%in%pattern)) # opcao retirar todos
return(chartr(paste(symbols, collapse=""), paste(nudeSymbols, collapse=""), str))
for(i in which(accentTypes%in%pattern))
str <- chartr(symbols[i],nudeSymbols[i], str)
return(str)
}
data4 <- data3 %>%
mutate(prov = rm_accent(prov),
dep = rm_accent(dep))
data4 <- data4 %>%
rename(DEPARTAMENTO = dep,
PROVINCIA = prov)
datos_finales <- left_join(data2,data4,by = c("DEPARTAMENTO","PROVINCIA"))
data_fin <- datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población)
data_fin <- datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(incidencia_acumulada = cumsum(incidencia))
data_fin
data_fin
data_fin <- datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(incidencia_acumulada = cumsum(incidencia)) %>%
mutate(date = paste0("date",gsub("","-",FECHA_RESULTADO)))
data_fin
data_fin <- datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(incidencia_acumulada = cumsum(incidencia)) %>%
mutate(date = paste0("date",gsub("","-",FECHA_RESULTADO))) %>%
select(date, incidencia_acumulada)
data_fin
datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(incidencia_acumulada = cumsum(incidencia)) %>%
mutate(date = paste0("date",gsub("","",FECHA_RESULTADO)))
datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(incidencia_acumulada = cumsum(incidencia)) %>%
mutate(date = paste0("date",gsub("","",FECHA_RESULTADO))) %>%
select(date, incidencia_acumulada)
datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(incidencia_acumulada = cumsum(incidencia)) %>%
mutate(date = paste0("date",gsub("-","",FECHA_RESULTADO))) %>%
select(date, incidencia_acumulada)
data_fin <- datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(incidencia_acumulada = cumsum(incidencia)) %>%
mutate(date = paste0("date",gsub("-","",FECHA_RESULTADO))) %>%
ungroup() %>%
select(date, incidencia_acumulada)
data_fin
atlas_pagename <- data_fin %>%
select(date)
write_csv(atlas_pagename,"atlas_pagename.csv")
data = data_fin %>%
pivot_wider(names_from = date,values_from = incidencia) %>%
replace(is.na(.), 0)
data = data_fin %>%
pivot_wider(names_from = date,values_from = incidencia_acumulada) %>%
replace(is.na(.), 0)
data
data_fin
data_fin <- datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(incidencia_acumulada = cumsum(incidencia)) %>%
mutate(date = paste0("date",gsub("-","",FECHA_RESULTADO))) %>%
ungroup() %>%
select(PROVINCIA,date, incidencia_acumulada)
data = data_fin %>%
pivot_wider(names_from = date,values_from = incidencia_acumulada) %>%
replace(is.na(.), 0)
data
write_csv(data,"casos.csv")
data_fin
data <- read_csv("covid_casos_positivos.csv")
data2 <- data %>%
filter(FECHA_RESULTADO < "2021-01-01")
data3 <- readxl::read_xlsx("reporte.xlsx") %>%
separate(Provincia , into = c("dep","name","prov"),sep = ",") %>%
select(dep,prov,Población) %>%
mutate_if(is.character,str_to_upper)
rm_accent <- function(str,pattern="all") {
if(!is.character(str))
str <- as.character(str)
pattern <- unique(pattern)
if(any(pattern=="Ç"))
pattern[pattern=="Ç"] <- "ç"
symbols <- c(
acute = "áéíóúÁÉÍÓÚýÝ",
grave = "àèìòùÀÈÌÒÙ",
circunflex = "âêîôûÂÊÎÔÛ",
tilde = "ãõÃÕñÑ",
umlaut = "äëïöüÄËÏÖÜÿ",
cedil = "çÇ"
)
nudeSymbols <- c(
acute = "aeiouAEIOUyY",
grave = "aeiouAEIOU",
circunflex = "aeiouAEIOU",
tilde = "aoAOnN",
umlaut = "aeiouAEIOUy",
cedil = "cC"
)
accentTypes <- c("´","`","^","~","¨","ç")
if(any(c("all","al","a","todos","t","to","tod","todo")%in%pattern)) # opcao retirar todos
return(chartr(paste(symbols, collapse=""), paste(nudeSymbols, collapse=""), str))
for(i in which(accentTypes%in%pattern))
str <- chartr(symbols[i],nudeSymbols[i], str)
return(str)
}
data4 <- data3 %>%
mutate(prov = rm_accent(prov),
dep = rm_accent(dep))
data4 <- data4 %>%
rename(DEPARTAMENTO = dep,
PROVINCIA = prov)
datos_finales <- left_join(data2,data4,by = c("DEPARTAMENTO","PROVINCIA"))
datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población)
datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,anio,mes) %>%
summarise(casos = n())
datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,anio,mes,Población) %>%
summarise(casos = n())
datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,anio,mes,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población)
mutate(date = sprintf("date2020%s",mes))
data_fin <- datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,anio,mes,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(date = sprintf("date2020%s",mes))
altas_pagename <- data_fin %>%
select(date)
altas_pagename
altas_pagename <- data_fin %>%
ungroup() %>%
select(date)
altas_pagename
write_csv(atlas_pagename,"atlas_pagename.csv")
data_fin
data = data_fin %>%
pivot_wider(names_from = date,values_from = incidencia) %>%
replace(is.na(.), 0)
data
write_csv(data,"casos.csv")
altas_pagename
datos_finales
data_fin <- datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia"))
data_fin
data_fin <- datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,anio,mes,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(date = sprintf("date2020%s",mes))
data_fin
altas_pagename <- data_fin %>%
ungroup() %>%
select(date)
write_csv(atlas_pagename,"atlas_pagename.csv")
altas_pagename
data_fin
data_fin %>%
ungroup()
data_fin <- datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,mes,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(date = sprintf("date2020%s",mes))
data_fin
altas_pagename <- data_fin %>%
select(date)
altas_pagename
altas_pagename <- data_fin %>%
select(date) %>% pull()
altas_pagename
altas_pagename <- data_fin %>%
select(date) %>% pull() %>%
as.data.frame()
altas_pagename
altas_pagename <- data_fin %>%
ungroup() %>%
select(date)
altas_pagename
write_csv(atlas_pagename,"atlas_pagename.csv")
atlas_pagename
write_csv(altas_pagename,"atlas_pagename.csv")
data_fin %>%
pivot_wider(names_from = date,values_from = incidencia) %>%
replace(is.na(.), 0)
data = data_fin %>%
pivot_wider(names_from = date,values_from = incidencia) %>%
replace(is.na(.), 0)
write_csv(data,"casos.csv")
data_fin
datos_finales
datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,mes)
data
data_fin %>%
pivot_wider(names_from = date,values_from = incidencia,values_fn = 'sum') %>%
replace(is.na(.), 0)
data_fin
data_fin
View(data_fin)
altas_pagename <- data_fin %>%
group_by(PROVINCIA,date) %>%
summarise(incidencia = sum(incidencia))
altas_pagename
View(altas_pagename)
write_csv(altas_pagename,"atlas_pagename.csv")
write_csv(altas_pagename,"casos.csv")
data = altas_pagename %>%
pivot_wider(names_from = date,values_from = incidencia) %>%
replace(is.na(.), 0)
write_csv(data,"casos.csv")
altas_pagename <- data_fin %>%
group_by(PROVINCIA,date) %>%
summarise(incidencia = sum(incidencia)) %>%
ungroup() %>%
select(date)
write_csv(altas_pagename,"atlas_pagename.csv")
altas_pagename <- data_fin %>%
group_by(PROVINCIA,date) %>%
summarise(incidencia = sum(incidencia)) %>%
ungroup() %>%
select(date) %>%
unique(date)
altas_pagename <- data_fin %>%
group_by(PROVINCIA,date) %>%
summarise(incidencia = sum(incidencia)) %>%
ungroup() %>%
select(date)
altas_pagename
data <-data.frame(date = unique(atlas_pagename$date))
data
altas_pagename
altas_pagename <- data_fin %>%
group_by(PROVINCIA,date) %>%
summarise(incidencia = sum(incidencia)) %>%
ungroup() %>%
select(date)
data.frame(date = unique(altas_pagename$date))
data <-data.frame(date = unique(altas_pagename$date))
data
write_csv(data,"atlas_pagename.csv")
data_fin
data_fin <- datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,mes) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(date = sprintf("date2020%s",mes)) %>%
select(PROVINCIA,date,casos,indicencia,)
data <- read_csv("covid_casos_positivos.csv")
data2 <- data %>%
filter(FECHA_RESULTADO < "2021-01-01")
data3 <- readxl::read_xlsx("reporte.xlsx") %>%
separate(Provincia , into = c("dep","name","prov"),sep = ",") %>%
select(dep,prov,Población) %>%
mutate_if(is.character,str_to_upper)
rm_accent <- function(str,pattern="all") {
if(!is.character(str))
str <- as.character(str)
pattern <- unique(pattern)
if(any(pattern=="Ç"))
pattern[pattern=="Ç"] <- "ç"
symbols <- c(
acute = "áéíóúÁÉÍÓÚýÝ",
grave = "àèìòùÀÈÌÒÙ",
circunflex = "âêîôûÂÊÎÔÛ",
tilde = "ãõÃÕñÑ",
umlaut = "äëïöüÄËÏÖÜÿ",
cedil = "çÇ"
)
nudeSymbols <- c(
acute = "aeiouAEIOUyY",
grave = "aeiouAEIOU",
circunflex = "aeiouAEIOU",
tilde = "aoAOnN",
umlaut = "aeiouAEIOUy",
cedil = "cC"
)
accentTypes <- c("´","`","^","~","¨","ç")
if(any(c("all","al","a","todos","t","to","tod","todo")%in%pattern)) # opcao retirar todos
return(chartr(paste(symbols, collapse=""), paste(nudeSymbols, collapse=""), str))
for(i in which(accentTypes%in%pattern))
str <- chartr(symbols[i],nudeSymbols[i], str)
return(str)
}
data4 <- data3 %>%
mutate(prov = rm_accent(prov),
dep = rm_accent(dep))
data4 <- data4 %>%
rename(DEPARTAMENTO = dep,
PROVINCIA = prov)
datos_finales <- left_join(data2,data4,by = c("DEPARTAMENTO","PROVINCIA"))
data_fin <- datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,mes) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(date = sprintf("date2020%s",mes)) %>%
select(PROVINCIA,date,casos,indicencia,)
datos_finales
data_fin <- datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,mes,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(date = sprintf("date2020%s",mes)) %>%
select(PROVINCIA,date,casos,indicencia,)
datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,mes,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(date = sprintf("date2020%s",mes))
data_fin <- datos_finales %>%
separate(FECHA_RESULTADO,into = c("anio","mes","dia")) %>%
group_by(PROVINCIA,mes,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
mutate(date = sprintf("date2020%s",mes)) %>%
select(PROVINCIA,date,casos,indicencia)
data_fin <- datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población)
data_fin
write_csv(data_fin,"indicencias_long.csv")
data_fin <- datos_finales %>%
group_by(FECHA_RESULTADO,PROVINCIA,Población) %>%
summarise(casos = n()) %>%
mutate(incidencia = casos*100000/Población) %>%
replace(is.na(.), 0)
write_csv(data_fin,"indicencias_long.csv")
data_fin
data_fin %>%
mutate(casus_acumulados = cumsum(incidencia))
data_fin %>%
group_by(incidencia) %>%
mutate(casus_acumulados = cumsum(incidencia))
data_fin %>%
group_by(PROVINCIA) %>%
mutate(casus_acumulados = cumsum(incidencia))
data_fin %>%
group_by(PROVINCIA) %>%
mutate(casus_acumulados = cumsum(incidencia))
data_fin %>%
ungroup() %>%
group_by(PROVINCIA) %>%
mutate(casus_acumulados = cumsum(incidencia))
data_fin
data_fin
data_fin %>%
group_by(PROVINCIA) %>%
summarise(incidencia = cumsum(incidencia))
data_fin %>%
group_by(FECHA_RESULTADO,PROVINCIA) %>%
summarise(incidencia = cumsum(incidencia))
write_csv(data_fin,"indicencias_long.csv")
data <- read_csv("caso2/casos.csv")
data
data %>%
pivot_longer(cols = date202003:date202012,names_to = "yearmonth",values_to = "cases")
data %>%
pivot_longer(cols = date202003:date202012,names_to = "yearmonth",values_to = "cases")
data %>%
pivot_longer(cols = date202003:date202012,
names_to = "yearmonth",
values_to = "cases")
data
data %>%
pivot_longer(cols = date202004:date202003,
names_to = "yearmonth",
values_to = "cases")
library(lubridate)
data %>%
pivot_longer(cols = date202004:date202003,
names_to = "yearmonth",
values_to = "cases") %>%
mutate(date = ym(yearmonth))
data %>%
pivot_longer(cols = date202004:date202003,
names_to = "yearmonth",
values_to = "cases") %>%
mutate(date = ym(yearmonth))
data %>%
pivot_longer(cols = date202004:date202003,
names_to = "yearmonth",
values_to = "cases") %>%
mutate(yearmonth = gsub("","date",yearmonth))
data %>%
pivot_longer(cols = date202004:date202003,
names_to = "yearmonth",
values_to = "cases") %>%
mutate(yearmonth = gsub("date","",yearmonth))
data %>%
pivot_longer(cols = date202004:date202003,
names_to = "yearmonth",
values_to = "cases") %>%
mutate(yearmonth = gsub("date","",yearmonth)) %>%
mutate(date = ym(yearmonth))
data %>%
pivot_longer(cols = date202004:date202003,
names_to = "yearmonth",
values_to = "cases") %>%
mutate(yearmonth = gsub("date","",yearmonth)) %>%
mutate(date = ym(yearmonth)) %>%
select(PROVINCIA,date,cases)
a = data %>%
pivot_longer(cols = date202004:date202003,
names_to = "yearmonth",
values_to = "cases") %>%
mutate(yearmonth = gsub("date","",yearmonth)) %>%
mutate(date = ym(yearmonth)) %>%
select(PROVINCIA,date,cases)
write_csv(a,"indicencias_long.csv")
